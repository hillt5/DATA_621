---
title: "Data 621 - Final Project"
author: "Devin Teran, Atina Karim, Tom Hill, Amit Kapoor"
date: "5/23/2021"
output:
  html_document:
    highlight: pygments
    number_sections: no
    theme: flatly
    toc: yes
    toc_float: yes
  pdf_document:
    toc: TRUE
    toc_depth: 2 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, error=FALSE, warning=FALSE, message=FALSE, fig.align = "center")
```


```{r loadData, include=FALSE}
# Libraries


library(DataExplorer)
library(visdat)
library(dplyr)
library(tidyr)
library(MASS)
library(psych)
library(AER)
library(mlr)
library(mice)
library(imputeTS)
library(ggplot2)

set.seed(621)
```


```{r data}

fires <- read.csv('https://raw.githubusercontent.com/hillt5/DATA_621/master/Final%20Project/uci-forest-fires/forestfires.csv', stringsAsFactors = TRUE) 

```


# Abstract  
For the final assignment, the team will be looking at a dataset of forest fires identified in Montesinho Natural Park, located in the mountainous northeast of Portugal. The original paper was published by a nearby university with the intention of offering low-cost prediction based on available meteorological measurements. Their model used information collected in realtime to identify fires without more specialized equipment - sattelite imaging and smoke scanners.   

The objective is to build a model that predicts the burned area of the forest given the explanatory variables. Additionally, a temporal model could be developed to understand which day and weather patterns offer the highest risk conditions.  

# Keywords    
Regression modeling, forest fires, meteorological measurements  

# Introduction    
Every year forest fires cause enormous amounts of destruction that results in the loss of human and animal life and economical and ecological loss.  Unpredictable forest fires make it very difficult for fire departments to plan in order to have an appropriate amount of resources in order to effectively fight all the fires.  By creating a model that usings meteorological measurements such as wind and relative humidity, fire departments would be able to be better prepared in order to fight fires more effectively and ideally decrease the amount of destruction that is caused each year by forest fires.  

# Literature Review  
**[A Data Mining Approach to Predict Forest Fires using Meterological Data](http://www3.dsi.uminho.pt/pcortez/fires.pdf) by Paulo Cortez and Anibal Morais** focused on using meterological data to predict smaller forest fires.  This study focused on meterological data because it can easily be captured through weather stations in real-time for low costs.  Other methods of infrared scanning and satellite are more expensive.  Their work used a SVM, neural network, multiple linear regression and other data mining methods in order to predict the weather conditions that created small fires.  While small fires are much more common than large fires, a drawback to this study is it doesn't predicte when large fires will occur.  The outcome of this study helps fire department manage resources by reaching fires more quickly.

The **Wildfire Burn Area Prediction paper by Adam Standford-Moore and Ben Moore** aimed to predicate the burn area of wildfires.  They used Kaggle data of historical wildfires in the United States from 1992-2015 and UCI dataset of wildfires in Portugal including info on first start and end date, longitude, latitude, year, and fire cause.  The UCI dataset included weather features, which proved to be important in the modeling.  Unlike other groups, this paper took all of the historical fires and binned them into 10 groups according to the fire size.  They then sampled 4,000 fires from each bin in order to complete their modeling.  Some of the bins with smaller fire sizes were heavily overrepresented in the data and they did this in an effort to balance the data.  This group used various modeling approaches including SVM, Neural Networks, K-Nearest Neighbors, Decision Trees, Linear Regression and more.  The best performance came from the SVM.  The smaller fire sizes proved easier to predict, which alines with some of the other studies.  This study found the features related to weather were more predictive over the historical fire data.

The article, **Predicting forest fires burned area and rate of spread from pre-fire multispectral satellite measurements, by Carmine Maffeia and Massimo Menenti** had an interesting take away that their focus was almost solely on moisture in the plant life on the ground.  They focused on weather conditions in an attempt to determine how it would affect the moisture levels in plant life since plants will fuel fire.  Plants with less moisture with burn quickly.  They were attempting to come up with their own function to measure the moisture content by focusing on plant moisture at different levels on the ground (surface vs deeper levels of organic matter).  They used various satellite imaging resources which was different from other studies in that this data collection is more expensive.  It'd be interesting to see how this studies findings impacts towns and their ability to obtain data through more expensive collection routes. Our analysis will not include these expensive data sources and instead will focus on meterological measurements as inexpensive data sources.

# Methodology
# Experimentation and Results
# Discussion and Conclusions
# References
# Appendices 




# Data Exploration

Below is the description of the variables of interest in the data set.

|VARIABLE NAME|DEFINITION|
|--|----|---|
|X|x-axis spatial coordinate within the Montesinho park map: 1 to 9|
|Y|y-axis spatial coordinate within the Montesinho park map: 2 to 9|
|month| month of the year: "jan" to "dec" |
|day|day of the week: "mon" to "sun"|
|FFMC*|Fine Fuel Moisture Code index from the FWI system: 18.7 to 96.20|
|DMC*|Duff Moisture Code index from the FWI system: 1.1 to 291.3 |
|DC*| Drought Code index from the FWI system: 7.9 to 860.6 |
|ISI*|Iniital Spread Index from the FWI system: 0.0 to 56.10|
|temp|temperature in Celsius degrees: 2.2 to 33.30|
|RH|relative humidity in %: 15.0 to 100|
|wind|wind speed in km/h: 0.40 to 9.40 |
|rain|outside rain in mm/m2 : 0.0 to 6.4 |
|area|the burned area of the forest (in ha): 0.00 to 1090.84 |  


*The FWI, or Fire Weather Index system, is an estimator developed in Canada for assessing fire risk. It ranges 0-20 and considers weather and fire conditions withing a critical period prior at the start of the fire.  The FFMC is a composite of rain, humidity, temperature and wind, DMC is rain, humidity and temperature, DC is rain and temperature, and finally ISI is a fire behavior index. One element of FWI, the buildup index, was not included as this is an indicator of the bulk fuel on the ground and not ascertainable from meteorology.  


Source : Cortez, Paulo & Morais, A.. (2007). A Data Mining Approach to Predict Forest Fires using Meteorological Data. 



## Statistics

All of the data are numeric and here is the statistics summary of all the predictors.

```{r, describe}
fires %>%  describe()
```

```{r months}
# unique months
fires %>% dplyr::select(month) %>% unique
```


```{r days}
# unique days
fires %>% dplyr::select(day) %>% unique
```


```{r fire-day}
# fires by day
fires_by_day <- fires %>% 
  group_by(day) %>% 
  summarise(total_by_day = n())

fires_by_day %>% 
  ggplot(aes(x=day, y=total_by_day)) + 
  geom_col()
```

```{r fire-month}

# fires by month
fires_by_month <- fires %>% 
  group_by(month) %>% 
  summarise(total_by_month = n())

fires_by_month %>% 
  ggplot(aes(x=month, y=total_by_month)) + 
  geom_col()
```

We can see in above 2 plots that fire frequency is more on weekends. Also Aug nd Sep are the months having most of the fire in the year.



## Numeric Variables

Exxcept for the day and month columns, all of these variables are numeric.  The original authors mention that area is likely to require log or some other transformation for best contribution to a model.  

```{r, histograms}
plot_histogram(fires, geom_histogram_args = list("fill" = "tomato4"))
```


```{r, distinct-values}
tibble(fires %>% summarize_all(n_distinct))
```


For distinct values, it appears that this region of Portugal does not have very routine rainfall.   



## Correlations

The `corrplot` below shows the correlation between predictor variables by ignoring the missing entries.

```{r, corrplot}
fire_corr <- fires[-c(3,4)]
corrplot::corrplot(cor(fire_corr), type = 'lower')
```

From the above `corrplot`, it is apparent that 

* `X` and `Y` are positively correlated, which is perhaps spurious or owing to the lack of distinct values for these variables.
* `temp` is positively correlated with several of the indices, 
* `temp` and `RH` are negatively correlated.



## Outliers

```{r}
fires %>% 
  dplyr::select(-month, -day,-area) %>% 
  pivot_longer(everything(), names_to = 'Var', values_to='Value') %>% 
  ggplot(aes(x = Var, y = Value)) +
  geom_boxplot() + 
  coord_flip()
```





## Missing Values

At first glance, there are no missing values in this dataset. However, only days with information about fires are added to the original dataset.The original paper mentions that readings spanned between January 2000 to December 2003, which would be a span of 1460 days as opposed to the 517 observations in the dataset. Since forest fires tend to be seasonal during a dry season, there may be a relationship to the data available for each month.  

```{r, months}


fires %>% group_by(month) %>% summarize(n())



```



The most observations are available for the month of August by a large margin.  March, July and February are the next most common months. January, May, and November have 2, 2, and 1 fires reported.

Looking at the August number, it's evident that multiple fires were happening per day during this time period.  This creates an interesting twist as multiple fires could strain firefighting resources and offers the prospect of considering a logistical or count as response variable if weather data were available for the missing dates.  It's also possible that the extra August observations there are duplicate entries as the observations were collected from two sources throughout the study.  


# Data Preparation


## Missing Values



# Build Models

```{r, }

summary(lm(fires, formula = area ~.))


```


# Select Models

# Code Appendix

```{r ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```

















